<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.yzunlp.qzfeng.mapper.UserHealthMapper">

    <insert id="addUserHealth"
            parameterType="com.yzunlp.qzfeng.domain.po.UserHealth"
            useGeneratedKeys="true"
            keyProperty="id">
        insert into Questionnaire.user_health
        (hypertension, hypertension_year, hypertension_drug, diabetes, diabetes_year, diabetes_drug, hyperlipidemia,
         hyperlipidemia_year, hyperlipidemia_drug, tumor)
            value (#{hypertension}, #{hypertensionYear}, #{hyperlipidemiaDrug}, #{diabetes}, #{diabetesYear},
                   #{diabetesDrug}, #{hyperlipidemia}, #{hypertensionYear}, #{hyperlipidemiaDrug}, #{tumor})
    </insert>

    <update id="updateUserHealth" parameterType="com.yzunlp.qzfeng.domain.po.UserHealth">
        update Questionnaire.user_health
        <set>
            <if test="hypertension != null">
                hypertension = #{hypertension},
            </if>
            <if test="hypertensionYear != null">
                hypertension_year = #{hypertensionYear},
            </if>
            <if test="hyperlipidemiaDrug != null">
                hyperlipidemia_drug = #{hyperlipidemiaDrug},
            </if>
            <if test="diabetes != null">
                diabetes = #{diabetes},
            </if>
            <if test="diabetesYear != null">
                diabetes_year = #{diabetesYear},
            </if>
            <if test="diabetesDrug != null">
                diabetes_drug = #{diabetesDrug},
            </if>
            <if test="hyperlipidemia != null">
                hyperlipidemia = #{hyperlipidemia},
            </if>
            <if test="hyperlipidemiaYear != null">
                hyperlipidemia_year = #{hyperlipidemiaYear},
            </if>
            <if test="hyperlipidemiaDrug != null">
                hyperlipidemia_drug = #{hyperlipidemiaDrug},
            </if>
            <if test="tumor != null">
                tumor = #{tumor}
            </if>
        </set>
        where id = #{id}
    </update>

    <select id="selectUserHealthByUserId" resultType="com.yzunlp.qzfeng.domain.po.UserHealth">
        SELECT uh.*
        FROM Questionnaire.info2health i2h
                 LEFT JOIN Questionnaire.user_health uh ON i2h.health_id = uh.id
        WHERE i2h.info_id = #{userId}
    </select>

    <insert id="addInfo2Health" parameterType="com.yzunlp.qzfeng.domain.po.Info2Health">
        insert into Questionnaire.info2health
            (info_id, health_id)
            value (#{infoId}, #{healthId})
    </insert>

    <select id="selectInfo2Health" resultType="com.yzunlp.qzfeng.domain.po.Info2Health">
        SELECT *
        FROM Questionnaire.info2health
        WHERE info_id = #{userId}
    </select>
</mapper>