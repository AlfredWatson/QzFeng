<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.yzunlp.qzfeng.mapper.UserInfoMapper">

    <insert id="addUser"
            parameterType="com.yzunlp.qzfeng.domain.dto.RegisterDTO">
        insert into Questionnaire.user_info
            (phone, name, password, china_id, birthday, sex, area_code)
            value (#{phone}, #{name}, #{password}, #{chinaId}, #{birthday}, #{sex}, #{areaCode})
    </insert>

    <!-- 查询手机号是否已存在 -->
    <select id="selectByPhone"
            parameterType="string"
            resultType="com.yzunlp.qzfeng.domain.po.UserInfo">
        SELECT *
        FROM Questionnaire.user_info
        WHERE phone = #{phone}
    </select>

    <select id="selectByPhoneAndPassword"
            parameterType="com.yzunlp.qzfeng.domain.dto.LoginDTO"
            resultType="com.yzunlp.qzfeng.domain.po.UserInfo">
        select *
        from Questionnaire.user_info
        where phone = #{phone}
          and password = #{password}
    </select>

    <select id="selectById" resultType="com.yzunlp.qzfeng.domain.po.UserInfo">

    </select>

    <insert id="saveHealthStatus" useGeneratedKeys="true" keyProperty="id">
        insert into Questionnaire.user_health
        (hypertension, hypertension_year, hypertension_drug, diabetes, diabetes_year, diabetes_drug, hyperlipidemia,
         hyperlipidemia_year, hyperlipidemia_drug, tumor)
            value (#{hypertension}, #{hypertensionYear}, #{hyperlipidemiaDrug}, #{diabetes}, #{diabetesYear},
                   #{diabetesDrug}, #{hyperlipidemia}, #{hypertensionYear}, #{hyperlipidemiaDrug}, #{tumor})
    </insert>

    <insert id="savePropolisUsage" parameterType="com.yzunlp.qzfeng.domain.po.UserPropolis">
        insert into Questionnaire.user_propolis
            (propolis, propolis_year, propolis_frequency, user_id, update_time)
            value (#{propolis}, #{propolisYear}, #{propolisFrequency}, #{userId}, #{updateTime})

    </insert>

    <insert id="saveInfo2health">
        insert into Questionnaire.info2health
            (info_id, health_id)
            value (#{infoId}, #{healthId})
    </insert>
    <insert id="saveEvaluation" parameterType="com.yzunlp.qzfeng.domain.po.UserEval">
        insert into Questionnaire.user_eval
            (evaluation, user_id, update_time)
            value (#{evaluation}, #{userId}, #{updateTime})
    </insert>
    <insert id="saveCheckUp" parameterType="com.yzunlp.qzfeng.domain.po.UserCheckupForm">
        insert into Questionnaire.user_checkup_form
            (user_id, pic_url)
            VALUE (#{userId}, #{picUrl})
    </insert>

</mapper>
