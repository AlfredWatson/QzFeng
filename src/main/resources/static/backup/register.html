<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8" />
    <title>用户注册</title>
    <style>
        label {
            display: inline-block;
            width: 100px;
        }
    </style>
</head>
<body>
<!-- 导航栏 -->
<nav>
    <a href="/static/login.html">回到登录页</a>
</nav>

<h2>用户注册</h2>
<form id="registerForm">
    <div class="form-group">
        <label for="phone">手机号：</label>
        <input type="text" id="phone" name="phone" required />
    </div>
    <div class="form-group">
        <label for="name">姓&nbsp;&nbsp;名：</label>
        <input type="text" id="name" name="name" required />
    </div>
    <div class="form-group">
        <label for="password">密&nbsp;&nbsp;码：</label>
        <input type="password" id="password" name="password" required placeholder="请输入密码" />
    </div>
    <div class="form-group">
        <label for="chinaId">身份证号：</label>
        <input type="text" id="chinaId" name="chinaId" required />
    </div>
    <div class="form-group">
        <label for="birthday">出生日期：</label>
        <input type="date" id="birthday" name="birthday" required />
    </div>
    <div class="form-group">
        <label>性&nbsp;&nbsp;别：</label>
        <select id="sex" name="sex" required>
            <option value="">请选择</option>
            <option value="1">男</option>
            <option value="2">女</option>
        </select>
    </div>
    <div class="form-group">
        <label for="areaCode">地区编码：</label>
        <input type="number" id="areaCode" name="areaCode" required />
    </div>
    <button type="submit">注册</button>
</form>

<div id="result"></div>

<script>
    document.getElementById('registerForm').addEventListener('submit', function (e) {
        e.preventDefault();

        const phone = document.getElementById('phone').value.trim();
        const name = document.getElementById('name').value.trim();
        const password = document.getElementById('password').value.trim(); // 新增密码字段
        const chinaId = document.getElementById('chinaId').value.trim();
        const birthday = document.getElementById('birthday').value;
        const sex = parseInt(document.getElementById('sex').value);
        const areaCode = parseInt(document.getElementById('areaCode').value);

        const registerDTO = {
            phone,
            name,
            password, // 提交密码
            chinaId,
            birthday,
            sex,
            areaCode
        };

        fetch('/user/info/register', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify(registerDTO)
        })
            .then(res => res.json())
            .then(data => {
                if (data.code === 1) {
                    alert('注册成功，请登录');
                    window.location.href = '/static/login.html';
                } else {
                    alert(data.msg);
                }
            })
            .catch(err => {
                console.error(err);
                document.getElementById('result').innerText = '注册失败，请重试';
            });
    });
</script>
</body>
</html>