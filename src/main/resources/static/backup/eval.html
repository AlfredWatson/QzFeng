<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>蜂胶使用主观评估</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 40px;
        }
        h2 {
            color: #333;
        }
        .question {
            margin-bottom: 15px;
        }
        label {
            display: inline-block;
            width: 250px;
        }
        select {
            padding: 5px;
        }
        .submit-btn {
            margin-top: 20px;
        }
    </style>
</head>
<body>
<!-- 导航栏 -->
<nav>
    <a href="/static/home.html">回到主页</a> |
    <a href="/static/user-info.html">填写基本信息</a> |
    <a href="/static/user-health.html">填写健康信息</a>
</nav>

<h2>二、主观评估</h2>
<h3>2.1 您觉得服用蜂胶后全身情况的改善体现在哪些方面？</h3>
<p>（评分范围：0=无效、1=有效、2=无此项、3=不详）</p>

<div class="question">
    <label for="cold">感冒较以往次数减少</label>
    <select id="cold">
        <option value="0">0=无效</option>
        <option value="1">1=有效</option>
        <option value="2">2=无此项</option>
        <option value="3">3=不详</option>
    </select>
</div>

<div class="question">
    <label for="sleep">睡眠质量改善</label>
    <select id="sleep">
        <option value="0">0=无效</option>
        <option value="1">1=有效</option>
        <option value="2">2=无此项</option>
        <option value="3">3=不详</option>
    </select>
</div>

<div class="question">
    <label for="digestion">胃肠道功能改善</label>
    <select id="digestion">
        <option value="0">0=无效</option>
        <option value="1">1=有效</option>
        <option value="2">2=无此项</option>
        <option value="3">3=不详</option>
    </select>
</div>

<div class="question">
    <label for="fatigue">身体疲乏感减轻</label>
    <select id="fatigue">
        <option value="0">0=无效</option>
        <option value="1">1=有效</option>
        <option value="2">2=无此项</option>
        <option value="3">3=不详</option>
    </select>
</div>

<div class="question">
    <label for="mouthUlcer">口腔溃疡次数减少</label>
    <select id="mouthUlcer">
        <option value="0">0=无效</option>
        <option value="1">1=有效</option>
        <option value="2">2=无此项</option>
        <option value="3">3=不详</option>
    </select>
</div>

<div class="question">
    <label for="throat">改善咽喉部不适感</label>
    <select id="throat">
        <option value="0">0=无效</option>
        <option value="1">1=有效</option>
        <option value="2">2=无此项</option>
        <option value="3">3=不详</option>
    </select>
</div>

<div class="submit-btn">
    <button onclick="submitEvaluation()">提交</button>
</div>

<script>
    const token = localStorage.getItem('Authorization');

    function submitEvaluation() {
        const cold = document.getElementById("cold").value;
        const sleep = document.getElementById("sleep").value;
        const digestion = document.getElementById("digestion").value;
        const fatigue = document.getElementById("fatigue").value;
        const mouthUlcer = document.getElementById("mouthUlcer").value;
        const throat = document.getElementById("throat").value;

        const evaluation = [cold, sleep, digestion, fatigue, mouthUlcer, throat].join(',');

        // 假设 userId 是从登录信息中获取的，这里用示例值代替
        // const userId = 123456;

        const data = {
            evaluation: evaluation,
            // userId: userId,
            // updateTime: new Date().toISOString().slice(0, 19).replace('T', ' ')
        };

        fetch('/user/eval', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': token
            },
            body: JSON.stringify(data)
        })
            .then(response => {
                if (response.ok) {
                    alert("提交成功！");
                } else {
                    alert("提交失败，请重试。");
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert("网络错误，请检查连接。");
            });
    }
</script>

</body>
</html>