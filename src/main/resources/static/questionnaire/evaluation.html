<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8" />
    <title>主观评估</title>
</head>
<body>
<!-- 导航栏 -->
<nav>
    <a href="/static/home.html">回到主页</a> |
    <a href="/static/user-info.html">填写基本信息</a> |
    <a href="/static/user-health.html">填写健康信息</a>
</nav>

<h2>二、主观评估</h2>
<form id="evalForm">
    <p>2.1 您觉得服用蜂胶后全身情况的改善体现在哪些方面？</p>
    <label><input type="checkbox" class="evalOption" value="0"> 感冒较以往次数减少</label><br>
    <label><input type="checkbox" class="evalOption" value="1"> 睡眠质量改善</label><br>
    <label><input type="checkbox" class="evalOption" value="2"> 胃肠道功能改善</label><br>
    <label><input type="checkbox" class="evalOption" value="3"> 身体疲乏感减轻</label><br>
    <label><input type="checkbox" class="evalOption" value="4"> 口腔溃疡次数减少</label><br>
    <label><input type="checkbox" class="evalOption" value="5"> 改善咽喉部不适感</label><br><br>

    <button type="submit">提交</button>
</form>

<script>
    const token = localStorage.getItem('token');

    document.getElementById('evalForm').addEventListener('submit', function (e) {
        e.preventDefault();
        const selected = Array.from(document.querySelectorAll('.evalOption'))
            .filter(cb => cb.checked)
            .map(cb => cb.value);

        const evalStr = selected.join(','); // "0,1,3"

        fetch('/user/evaluation', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': token
            },
            body: JSON.stringify({ evaluation: evalStr })
        })
            .then(res => res.json())
            .then(() => alert("提交成功"));
    });
</script>
</body>
</html>